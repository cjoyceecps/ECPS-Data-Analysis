{"version":"0.2.0","body":"function main(workbook: ExcelScript.Workbook) {\n  const maxc = 100; //There are at most this many columns of data\n\n  let sheet = workbook.getActiveWorksheet(); //Currently opened spreadsheet\n  let col = sheet.getUsedRange(true).getColumn(0); //First (non-empty) column in the active spreadsheet\n  col.convertDataTypeToText; //Set all the cells in the first column to \"text\", in case they were previously numbers\n  let dat = col.getValues(); //Store all the data in a 2D array\n  dat.reverse(); //Otherwise the top entry of the formatted data will be the last entry of the raw data\n  for (let i of dat) { //`i` represents the 1-cell-wide row of data\n    if (typeof (i[0]) === \"string\") { //If the first (and only) cell is text, then:\n      let st = i[0].split(\" \").slice(1); //Split the cell into an array of words separated by spaces and discard the first element (the index number)\n      st.pop(); //Discard the last element (the backwards arrow character)\n      while (st[2].match(/\\D/)) { //While there is a word (i.e, part of a last name) where the grade number should be, do:\n        st[1] = st[1].concat(\" \", st[2]); //Merge that part of their last name with the existing last name\n        st.splice(2, 1); //Discard the fragment\n      }\n      st[5] = st[5].concat(\" \", st[6]); //Merge the two words from achievement level to put `Not Proficient` and `Level 3/4/5` in the same cell\n      st.splice(6, 1); //Discard the fragment\n      //console.log(st);\n      let frs = sheet.getRange(\"1:1\");  //Get the first row of the sheet\n      frs.insert(ExcelScript.InsertShiftDirection.down); //Insert a new row above the current first row\n      while (st.length < maxc) { //While there are fewer than `maxc` (by default 100) elements in the `st` string array, pad the array with empty data\n        st.push(\"\");\n      }\n      sheet.getRangeByIndexes(0,1,1,maxc).setValues([st,]); //Store the formatted array as the first `maxc` elements of the new first row\n    }\n  }\n  sheet.getRange(\"A1\").getEntireColumn().delete(ExcelScript.DeleteShiftDirection.left); //Delete the first column of the spreadsheet, which has the old data; comment out this row if you wish to keep the raw data\n  sheet.getRange(\"A1\").getEntireRow().getFormat().autofitColumns(); //Widen and shrink the cells of the spreadsheet to fit the data\n}","description":"","parameterInfo":"{\"originalParameterOrder\":[],\"parameterSchema\":{\"type\":\"object\",\"default\":{},\"x-ms-visibility\":\"internal\"},\"returnSchema\":{\"type\":\"object\",\"properties\":{}}}","apiInfo":"{\"variant\":\"synchronous\",\"variantVersion\":2}"}